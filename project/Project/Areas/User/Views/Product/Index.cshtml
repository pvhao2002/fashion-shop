@model Project.Areas.User.ViewModel.ProductViewModel

@{
  ViewBag.Title = "Sản phẩm";
  Layout = "~/Areas/User/Views/Shared/_Layout.cshtml";
}

@section css {
  <link rel="stylesheet" media="screen" href="~/Content/User/leaflet.css"/>
  <link rel="stylesheet" media="screen" href="~/Content/User/filepond-plugin-image-preview.min.css"/>
  <link rel="stylesheet" media="screen" href="~/Content/User/filepond.min.css"/>
}

<div class="container mt-5 mb-md-4 py-5">
  <div class="row py-md-1">
    <div class="col-lg-3 pe-xl-4">
      <div class="offcanvas offcanvas-start offcanvas-collapse bg-dark" id="filters-sidebar">
        <div class="offcanvas-header bg-transparent d-flex d-lg-none align-items-center">
          <h2 class="h5 text-light mb-0">Lọc</h2>
          <button class="btn-close btn-close-white" type="button" data-bs-dismiss="offcanvas"></button>
        </div>
        <div class="offcanvas-body py-lg-4">
          <div class="pb-4 mb-2">
            <h3 class="h6 text-light">Danh mục</h3>
            <select class="form-select form-select-light mb-2" id="cate1">
              <option value="0">Tất cả</option>
              @foreach (var c in Model.ListCategory)
              {
                <option value="@c.category_id">@c.category_name</option>
              }
            </select>
          </div>

          <div class="pb-4 mb-2">
            <h3 class="h6 text-light">Price</h3>
            <div class="range-slider range-slider-light mb-3">
              <div class="d-flex align-items-center">
                <div class="w-50 pe-2">
                  <input class="form-control form-control-light range-slider-value-min" type="text" placeholder="0">
                </div>
                <div class="text-muted">&mdash;</div>
                <div class="w-50 ps-2">
                  <input class="form-control form-control-light range-slider-value-max" type="text"
                         placeholder="99999999">
                </div>
              </div>
            </div>
          </div>
          <div class="pb-4 mb-2">
            <button class="btn btn-primary w-100" type="button">Tìm</button>
          </div>
        </div>
      </div>
    </div>
    <!-- Catalog list view-->
    <div class="col-lg-9">
      <!-- Breadcrumb-->
      <nav class="mb-3 pt-md-2 pt-lg-4" aria-label="Breadcrumb">
        <ol class="breadcrumb breadcrumb-light">
          <li class="breadcrumb-item"><a href="/User">Trang chủ</a></li>
          <li class="breadcrumb-item active" aria-current="page">Sản phẩm</li>
        </ol>
      </nav>
      <!-- Page title-->
      <div class="d-flex align-items-center justify-content-between pb-4 mb-2">
        <h1 class="text-light me-3 mb-0">Mua sắm</h1>
        <div class="text-light"><i class="fi-shop fs-lg me-2"></i><span class="align-middle">@Model.TotalProduct sản phẩm</span>
        </div>
      </div>
      <!-- Sorting + View-->
      <div class="d-sm-flex align-items-center justify-content-between pb-4 mb-2">
        <div class="d-flex align-items-center me-sm-4">
          <label class="fs-sm text-light me-2 pe-1 text-nowrap" for="sorting1">
            <i class="fi-arrows-sort mt-n1 me-2"></i>Sắp xếp
          </label>
          <select class="form-select form-select-light form-select-sm me-sm-4" id="sorting1">
            <option>Mới nhất</option>
            <option>Phổ biến</option>
            <option>Giá: Thấp - Cao</option>
            <option>Giá: Cao - Thấp</option>
          </select>
        </div>
      </div>
      <!-- Item-->
      @foreach (var pro in Model.Products)
      {
        <div class="card card-light card-hover card-horizontal mb-4">
          <div class="tns-carousel-wrapper card-img-top card-img-hover">
            <a class="img-overlay" href="/User/Product/Details/@pro.ProductId"></a>
            <div class="content-overlay end-0 top-0 pt-3 pe-3">
              <button class="btn btn-icon btn-light btn-xs text-primary rounded-circle" type="button"
                      data-bs-toggle="tooltip" data-bs-placement="left" title="Add to Wishlist"><i class="fi-heart"></i>
              </button>
            </div>
            <div id="carousel-@pro.ProductId" class="carousel slide h-100" data-bs-ride="carousel"
                 style="height: 200px;">
              <div class="carousel-inner h-100" style="height: 200px;">
                @for (int i = 0; i < pro.Images.Count; i++)
                {
                  var img = pro.Images[i];
                  <div class="carousel-item @(i == 0 ? "active" : "") h-100">
                    <img src="@Url.Content(img.ImageUrl)" style="height: 200px;"
                         class="d-block w-100 h-100 object-fit-cover"
                         alt="Product Image"/>
                  </div>
                }
              </div>

              <!-- Nút điều hướng -->
              <button class="carousel-control-prev" type="button" data-bs-target="#carousel-@pro.ProductId"
                      data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Trước</span>
              </button>
              <button class="carousel-control-next" type="button" data-bs-target="#carousel-@pro.ProductId"
                      data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Sau</span>
              </button>
            </div>
          </div>
          <div class="card-body">
            <div class="d-flex align-items-center justify-content-between pb-1">
              <span
                class="fs-sm text-light me-3">@(pro.Category?.CategoryName)</span>
            </div>
            <h3 class="h6 mb-1"><a class="nav-link-light" href="/User/Product/Details/@pro.ProductId">@pro.Name</a></h3>
            <div class="text-primary fw-bold mb-1">@($"{pro.Price:n0}") đ</div>
            <div class="fs-sm text-light opacity-70">
              <span><i class="fi-ticket me-1"></i>Tồn kho: @pro.Stock</span>
              <span class="mx-2">|</span>
              <span><i class="fi-eye me-1"></i>Ngày đăng: @(pro?.CreatedAt?.ToString("HH:mm dd/MM/yyyy"))</span>
              <span class="mx-2">|</span>
              <span><i class="fi-eye me-1"></i>Bình luận: 0</span>
            </div>
            <div class="border-top border-light mt-3 pt-3">
              @pro.Description
            </div>
            <div class="border-top border-light mt-3 pt-3">
              <button class="btn btn-outline-primary" onclick="addToCart(@(pro.ProductId))">
                <i class="fi-cart me-1"></i> Thêm vào giỏ hàng
              </button>
            </div>
          </div>
        </div>
      }

      <!-- Sorting + Pagination-->
      <div class="d-flex align-items-center justify-content-between py-2 d-none">
        <div class="d-flex align-items-center me-sm-4">
          <label class="fs-sm text-light me-2 pe-1 text-nowrap" for="sorting2"><i class="fi-arrows-sort mt-n1 me-2"></i>Sort
            by:</label>
          <select class="form-select form-select-light form-select-sm me-2 me-sm-4" id="sorting2">
            <option>Newest</option>
            <option>Popular</option>
            <option>Price: Low - High</option>
            <option>Price: Hight - Low</option>
          </select>
          <div class="d-none d-md-block border-end border-light" style="height: 1.25rem;"></div>
          <div class="d-none d-md-block fw-bold text-light opacity-70 text-nowrap ps-md-4"><i
              class="fi-switch-horizontal me-2"></i><span class="align-middle">Compare (0)</span></div>
        </div>
        <nav aria-label="Pagination">
          <ul class="pagination pagination-light mb-0">
            <li class="page-item d-sm-none text-nowrap"><span class="page-link page-link-static">1 / 5</span></li>
            <li class="page-item active d-none d-sm-block" aria-current="page"><span class="page-link">1<span
                  class="visually-hidden">(current)</span></span></li>
            <li class="page-item d-none d-sm-block"><a class="page-link" href="#">2</a></li>
            <li class="page-item d-none d-sm-block"><a class="page-link" href="#">3</a></li>
            <li class="page-item d-none d-sm-block">...</li>
            <li class="page-item d-none d-sm-block"><a class="page-link" href="#">8</a></li>
            <li class="page-item"><a class="page-link" href="#" aria-label="Next"><i class="fi-chevron-right"></i></a>
            </li>
          </ul>
        </nav>
      </div>
    </div>
  </div>
</div>

@section vendor {
  <script src="~/Scripts/User/nouislider.min.js"></script>
  <script src="~/Scripts/User/cleave.min.js"></script>
  <script src="~/Scripts/User/detail-product.js"></script>
}